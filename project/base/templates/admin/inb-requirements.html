{% extends 'base.html' %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/req.css' %}">

<h1>Iskolar ng Bayan Requirements</h1>

<div>
    <button class="edit-button" onclick="window.location.href='{% url 'update_req' %}'">Go Back</button>
</div>

<ul>
    {% if requirements %}
        {% for requirement in requirements %}
            <p class="req-text">
                <button class="edit-button update-requirement-link" data-requirement-id="{{ requirement.id }}">
                    <i class="fa-solid fa-pencil"></i>
                </button>

                <i class="fa-solid fa-trash" id="openDeleteModal"></i>
                {{ requirement.requirement }}
            </p>
        {% endfor %}
    {% else %}
        <li>No requirements found</li>
    {% endif %}
</ul>

<div id="updateRequirementConfirmationContainer" class="update-modal-container">
    <div class="update-modal">
        <h1>Edit <span id="editRequirementName"></span> (ID: <span id="editRequirementId"></span>)</h1>
        <form method="POST" id="updateRequirementForm">
            {% csrf_token %}
            <input type="text" name="requirement" id="editRequirementInput" class="form-control">
            <input type="hidden" name="requirement_id" id="editRequirementIdInput" value="">
            <div class="inline-flex-container">
                <button class="modal-button" type="submit">Yes</button>
                <button class="modal-button" id="updateRequirementNoButton">No</button>
            </div>
        </form>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        var updateRequirementLinks = document.querySelectorAll('.update-requirement-link');
        var editRequirementInput = document.getElementById('editRequirementInput');
        var editRequirementIdInput = document.getElementById('editRequirementIdInput');
        var updateRequirementForm = document.getElementById('updateRequirementForm');
        var updateRequirementConfirmationContainer = document.getElementById('updateRequirementConfirmationContainer');
    
        updateRequirementLinks.forEach(function (link) {
            link.addEventListener('click', function (event) {
                event.preventDefault();
    
                var requirementId = link.getAttribute('data-requirement-id');
                var requirementName = link.closest('.req-text').textContent.trim();
    
                updateRequirementForm.action = `/Update_IskolarngBayan_Requirement/${requirementId}/`;
                editRequirementIdInput.value = requirementId;

                editRequirementInput.value = requirementName;
    
                updateRequirementConfirmationContainer.style.display = 'flex';
                updateRequirementConfirmationContainer.style.position = 'fixed';
                updateRequirementConfirmationContainer.style.top = '50%';
                updateRequirementConfirmationContainer.style.left = '50%';
                updateRequirementConfirmationContainer.style.transform = 'translate(-50%, -50%)';
            });
        });
    
        document.getElementById('updateRequirementNoButton').addEventListener('click', function () {
            updateRequirementConfirmationContainer.style.display = 'none';
        });
    });
</script>

{% endblock %}
